<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Connecting to R Studio Server via a docker on a remote server • rutils</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Connecting to R Studio Server via a docker on a remote server">
<meta property="og:description" content="rutils">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rutils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/rutils.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/rocker_setup.html">Connecting to R Studio Server via a docker on a remote server</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dzhang32/rutils/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="rocker_setup_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Connecting to R Studio Server via a docker on a remote server</h1>
                        <h4 data-toc-skip class="author">David Zhang</h4>
            <address class="author_afil">
      UCL<br><h4 data-toc-skip class="date">02 September 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dzhang32/rutils/blob/master/vignettes/rocker_setup.Rmd" class="external-link"><code>vignettes/rocker_setup.Rmd</code></a></small>
      <div class="hidden name"><code>rocker_setup.Rmd</code></div>

    </address>
</div>

    
    
<blockquote>
<p>Aim: Connect to R Studio server using docker</p>
</blockquote>
<p><br><br></p>
<div id="background" class="section level1">
<h1 class="hasAnchor">
<a href="#background" class="anchor" aria-hidden="true"></a>Background</h1>
<ul>
<li>
<a href="https://www.rstudio.com/products/rstudio/download-server/" class="external-link">R Studio server</a> allows user’s to code using a convenient IDE, whilst harnessing the processing power of a computing cluster/server.</li>
<li>However, the installation and maintenance of the R Studio server software can be time-consuming. Also, the free version of R Studio server only permits a single version of <code>R</code> to be used. Assuming you are not willing to pay, this can limit analyses that depend on packages across multiple versions of R.</li>
<li>Using an docker image from the <a href="https://hub.docker.com/r/rocker/rstudio" class="external-link">rocker project</a> with R/R Studio server pre-installed, you can easily bypass the two limitations above. A user can connect to the <code>rocker</code> image via an <code>ssh</code> tunnel, accessing R Studio server through their local web browser. Each docker image can have a unique installation of R Studio server, thus any number of <code>R</code> versions can be used.</li>
<li>The following guide with demonstrate how to install and connect to a R Studio server via a <code>rocker</code> image on a remote server.</li>
<li>This guide does <strong>not</strong> cover the fundamentals of docker itself and it is recommended that anyone using this guide should already have a basic proficiency with docker.</li>
</ul>
<p><br><br></p>
</div>
<div id="guide" class="section level1">
<h1 class="hasAnchor">
<a href="#guide" class="anchor" aria-hidden="true"></a>Guide</h1>
<div id="docker-installation" class="section level2">
<h2 class="hasAnchor">
<a href="#docker-installation" class="anchor" aria-hidden="true"></a>Docker installation</h2>
<p>You must have <code>docker</code> installed on your system. To check you have <code>docker</code> installed, you can use:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># based on: https://www.digitalocean.com/community/questions/how-to-check-for-docker-installation</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> <span class="at">-v</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$?</span></span></code></pre></div>
<p>If you don’t, install <code>docker</code>. A guide to installing <code>docker</code> can be found <a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-18-04" class="external-link">here</a>.</p>
<p><br><br></p>
</div>
<div id="download-a-docker-image-with-r-studio-server-pre-installed" class="section level2">
<h2 class="hasAnchor">
<a href="#download-a-docker-image-with-r-studio-server-pre-installed" class="anchor" aria-hidden="true"></a>Download a docker image with R Studio server pre-installed</h2>
<p>In order to use R Studio server, a <code>docker</code> image with R Studio server pre-installed must be downloaded. <a href="https://www.bioconductor.org/help/docker/" class="external-link">Bioconductor</a> releases it’s own image based on the <code>rocker project</code>, with other useful resources for analyses of biological data pre-installed, such as core Bioconductor packages. You can download the Bioconductor docker image using:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the release 3.13 version of Bioconductor rocker image is used here</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># be sure to check for an updated version as and when you use this guide</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> docker pull bioconductor/bioconductor_docker:RELEASE_3_13</span></code></pre></div>
<p><br><br></p>
</div>
<div id="start-a-r-studio-server-process" class="section level2">
<h2 class="hasAnchor">
<a href="#start-a-r-studio-server-process" class="anchor" aria-hidden="true"></a>Start a R Studio server process</h2>
<p>Next, we will create a process running R Studio server on the Bioconductor docker image downloaded above. To do this, you need to use various flags together with the <code>docker</code> command. For convenience, I have created a <code>R</code> wrapper function to run these docker commands within the function <a href="https://github.com/dzhang32/rutils/blob/master/R/docker_shell.R" class="external-link">rutils::docker_run_rserver</a>. This calls the relevant docker commands from within <code>R</code> with arguments for the relevant flags, which are explained below.</p>
<p>First, open an <code>R</code> terminal and install the <code>rutils</code> package from GitHub via:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># this requires R version &gt;= 4.0</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"dzhang32/rutils"</span><span class="op">)</span></code></pre></div>
<p>Next, run the <code><a href="../reference/docker_run_rserver.html">rutils::docker_run_rserver()</a></code> function within the <code>R</code> terminal. At a minimum, you should set the <code>image</code>, <code>port</code> and <code>name</code> arguments explained below. Setting the <code>verbose</code> argument to TRUE will print the flags that were used within the <code>docker</code> command and can be useful for debugging or logging your session.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="../reference/docker_run_rserver.html">docker_run_rserver</a></span><span class="op">(</span>
    image <span class="op">=</span> <span class="st">"bioconductor/bioconductor_docker:RELEASE_3_13"</span>, <span class="co"># rocker image</span>
    port <span class="op">=</span> <span class="fl">8787</span>, <span class="co"># port on which the host will have present R Studio server</span>
    name <span class="op">=</span> <span class="st">"example"</span>, <span class="co"># name of docker process</span>
    verbose <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># whether to print out the flags passed to the docker command</span>
<span class="op">)</span></code></pre></div>
<p><br><br></p>
</div>
<div id="connecting-to-a-r-studio-server-process" class="section level2">
<h2 class="hasAnchor">
<a href="#connecting-to-a-r-studio-server-process" class="anchor" aria-hidden="true"></a>Connecting to a R Studio server process</h2>
<p>Now that the R Studio server process is running, you can now map the <code>localhost</code> of your local machine to the <code>port</code> on the remote server presenting R Studio server (specified above as 8787). An example <code>ssh</code> command is shown below and should be run on your <strong>local</strong> terminal:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># make sure the port specified here matches the port you have used above in </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rutils::docker_run_rserver()</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh</span> <span class="at">-i</span> path_to_pem.pem <span class="dt">\</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>-X <span class="at">-N</span> <span class="at">-f</span> <span class="at">-L</span> localhost:8787:localhost:8787 <span class="dt">\</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>user@ip</span></code></pre></div>
<p>If the above <code>ssh</code> command has run successfully, you will now be able to access R Studio server by going to the address <code>localhost:8787</code> on your local browser. The default login details for the Bioconductor docker are:</p>
<p>Username: <strong>rstudio</strong></p>
<p>Password: <strong>bioc</strong></p>
<p>More details of the Bioconductor docker can be found <a href="https://www.bioconductor.org/help/docker/" class="external-link">here</a>.</p>
<p><br><br></p>
</div>
<div id="mounting-volumes" class="section level2">
<h2 class="hasAnchor">
<a href="#mounting-volumes" class="anchor" aria-hidden="true"></a>Mounting volumes</h2>
<p>Most analyses relies on data that is stored on the original host, therefore not (by default) accessible by the docker process. Therefore, it is often useful to mount the required files, allowing them to be accessible by the <code>docker</code> process. Mounting can be configured using <code><a href="../reference/docker_run_rserver.html">rutils::docker_run_rserver()</a></code> via the arguments <code>volumes</code>, <code>volumes_ro</code>.</p>
<p>The user permissions for accessing the mounted <code>volumes</code> are dictated by the <code>USERID</code> and <code>GROUPID</code> arguments. These should be set matching the user you would like to mirror the permissions of. On linux, the <code>USERID</code> and <code>GROUPID</code> of the current user can be obtained via the <code>bash</code> command <code>id</code>.</p>
<p>Below is an example of running <code><a href="../reference/docker_run_rserver.html">rutils::docker_run_rserver()</a></code> whilst mounting volumes:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># volumes - paths will be mounted with user permissions</span>
<span class="co"># matching user specified by the USERID and GROUPID arguments</span>
<span class="co"># volumes_ro - paths will be mounted with read-only access</span>
<span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="../reference/docker_run_rserver.html">docker_run_rserver</a></span><span class="op">(</span>
    image <span class="op">=</span> <span class="st">"bioconductor/bioconductor_docker:RELEASE_3_13"</span>,
    port <span class="op">=</span> <span class="fl">8787</span>,
    name <span class="op">=</span> <span class="st">"example_2"</span>,
    verbose <span class="op">=</span> <span class="cn">TRUE</span>,
    volumes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
        <span class="st">"/path/to/mounted/dir"</span>
    <span class="op">)</span>,
    volumes_ro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
        <span class="st">"/path/to/mounted/dir"</span>
    <span class="op">)</span>,
    permissions <span class="op">=</span> <span class="st">"match"</span>,
    USERID <span class="op">=</span> <span class="fl">1000</span>,
    GROUPID <span class="op">=</span> <span class="fl">1000</span>
<span class="op">)</span></code></pre></div>
<p><br><br></p>
</div>
</div>
<div id="reproducibility" class="section level1">
<h1 class="hasAnchor">
<a href="#reproducibility" class="anchor" aria-hidden="true"></a>Reproducibility</h1>
<pre><code>## ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────
##  setting  value                       
##  version  R version 4.0.3 (2020-10-10)
##  os       Ubuntu 20.04 LTS            
##  system   x86_64, linux-gnu           
##  ui       X11                         
##  language (EN)                        
##  collate  en_US.UTF-8                 
##  ctype    en_US.UTF-8                 
##  tz       Etc/UTC                     
##  date     2021-09-02                  
## 
## ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────
##  package     * version    date       lib source                        
##  assertthat    0.2.1      2019-03-21 [2] RSPM (R 4.0.3)                
##  bookdown      0.21       2020-10-13 [1] RSPM (R 4.0.2)                
##  cachem        1.0.4      2021-02-13 [2] RSPM (R 4.0.3)                
##  cli           2.3.0      2021-01-31 [2] RSPM (R 4.0.3)                
##  crayon        1.4.1      2021-02-08 [2] RSPM (R 4.0.3)                
##  desc          1.2.0      2018-05-01 [2] RSPM (R 4.0.3)                
##  digest        0.6.27     2020-10-24 [2] RSPM (R 4.0.3)                
##  evaluate      0.14       2019-05-28 [2] RSPM (R 4.0.3)                
##  fastmap       1.1.0      2021-01-25 [2] RSPM (R 4.0.3)                
##  fs            1.5.0      2020-07-31 [2] RSPM (R 4.0.3)                
##  glue          1.4.2      2020-08-27 [2] RSPM (R 4.0.3)                
##  htmltools     0.5.1.1    2021-01-22 [2] RSPM (R 4.0.3)                
##  knitr       * 1.31       2021-01-27 [2] RSPM (R 4.0.3)                
##  magrittr      2.0.1      2020-11-17 [2] RSPM (R 4.0.3)                
##  memoise       2.0.0      2021-01-26 [2] RSPM (R 4.0.3)                
##  pkgdown       1.6.1.9001 2021-09-02 [1] Github (r-lib/pkgdown@705ff7c)
##  R6            2.5.0      2020-10-28 [2] RSPM (R 4.0.3)                
##  ragg          1.1.0      2021-02-15 [1] RSPM (R 4.0.3)                
##  rlang         0.4.10     2020-12-30 [2] RSPM (R 4.0.3)                
##  rmarkdown     2.6        2020-12-14 [1] RSPM (R 4.0.3)                
##  rprojroot     2.0.2      2020-11-15 [2] RSPM (R 4.0.3)                
##  sessioninfo * 1.1.1      2018-11-05 [2] RSPM (R 4.0.3)                
##  stringi       1.5.3      2020-09-09 [2] RSPM (R 4.0.3)                
##  stringr       1.4.0      2019-02-10 [2] RSPM (R 4.0.3)                
##  systemfonts   1.0.1      2021-02-09 [1] RSPM (R 4.0.3)                
##  textshaping   0.3.0      2021-02-10 [1] RSPM (R 4.0.3)                
##  withr         2.4.1      2021-01-26 [2] RSPM (R 4.0.3)                
##  xfun          0.21       2021-02-10 [2] RSPM (R 4.0.3)                
##  yaml          2.2.1      2020-02-01 [2] RSPM (R 4.0.3)                
## 
## [1] /__w/_temp/Library
## [2] /usr/local/lib/R/site-library
## [3] /usr/local/lib/R/library</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David Zhang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
